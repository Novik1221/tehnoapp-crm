<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>TEHNOAPP CRM ‚Äî –£–ø—Ä–∞–≤–ª—è–π –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ—Å—Ç–æ –∏ –∫—Ä–∞—Å–∏–≤–æ</title>
<meta name="theme-color" content="#FF8CCF"/>
<link rel="icon" href="data:,"/>
<style>
:root{--pink:#FF8CCF;--blue:#6EC1E4;--card:#fbfbfe;--text:#222;--muted:#666}
*{box-sizing:border-box}html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#fff,#fbfbff);-webkit-font-smoothing:antialiased;color:var(--text)}
.container{max-width:1100px;margin:16px auto;padding:16px}
.header{display:flex;align-items:center;justify-content:space-between}
.logo{font-weight:800;font-size:22px;background:linear-gradient(90deg,var(--pink),var(--blue));-webkit-background-clip:text;color:transparent}
.subtitle{font-size:13px;color:var(--muted);margin-top:2px}
.actions{display:flex;gap:8px;align-items:center}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.btn-primary{background:linear-gradient(90deg,var(--pink),var(--blue));color:white;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
.btn-ghost{background:transparent;border:1px solid #ececec;color:var(--text)}
.card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.04);border:1px solid #f2f2f8}
.grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
.input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e9e9ef;font-size:14px;background:white}
textarea{min-height:90px;resize:vertical}
.leads-list{display:grid;gap:10px;margin-top:12px}
.lead-item{display:flex;justify-content:space-between;align-items:flex-start;padding:12px;border-radius:10px;background:white;border:1px solid #f3f3f6}
.lead-meta{font-size:13px;color:var(--muted)}
.small{font-size:12px;color:var(--muted)}
.search{flex:1;min-width:140px}
.select{width:200px}
.footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px;padding:14px}
.badge{padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;color:white;background:linear-gradient(90deg,var(--pink),var(--blue))}
.empty{padding:18px;text-align:center;color:var(--muted);background:#fff;border-radius:10px;border:1px dashed #f0f0f5}
.modal-backdrop{position:fixed;inset:0;background:rgba(8,10,20,0.35);display:flex;align-items:center;justify-content:center;z-index:9999}
.modal{background:white;padding:22px;border-radius:14px;max-width:520px;width:92%;box-shadow:0 20px 60px rgba(2,6,23,0.18);text-align:center}
.modal h3{margin:0 0 8px;font-size:22px;background:linear-gradient(90deg,var(--pink),var(--blue));-webkit-background-clip:text;color:transparent}
.warning-box{display:none;padding:12px;border-radius:10px;background:#fff4e6;border:1px solid #ffe3b8;color:#7a4b00;margin-bottom:12px}
.table{width:100%;border-collapse:collapse;margin-top:12px}
.table th{text-align:left;padding:10px;background:#fafafa;border-bottom:1px solid #f1f1f6;font-size:13px;color:var(--muted)}
.table td{padding:10px;border-bottom:1px solid #f7f7fb;font-size:14px}
</style>
</head>
<body>
<div class="container" id="app">
  <div class="header">
    <div>
      <div class="logo">TEHNOAPP</div>
      <div class="subtitle">—É–ø—Ä–∞–≤–ª—è–π –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ—Å—Ç–æ –∏ –∫—Ä–∞—Å–∏–≤–æ</div>
    </div>
    <div class="actions">
      <button id="exportBtn" class="btn btn-ghost">–≠–∫—Å–ø–æ—Ä—Ç CSV</button>
      <label class="btn btn-ghost" for="importInput" style="cursor:pointer">–ò–º–ø–æ—Ä—Ç CSV</label>
      <input id="importInput" class="import-file" type="file" accept=".csv" style="display:none">
      <button id="clearBtn" class="btn btn-ghost">–û—á–∏—Å—Ç–∏—Ç—å</button>
      <button id="deleteAllBtn" class="btn btn-ghost">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
      <button id="addBtn" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
    </div>
  </div>

  <div id="storageWarning" class="warning-box">‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–µ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ) –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥ (GitHub Pages, Netlify –∏ —Ç.–¥.).</div>

  <div class="card" style="margin-top:12px">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div><strong>–°–ø–∏—Å–æ–∫ –ª–∏–¥–æ–≤</strong><div class="small">–í—Å–µ–≥–æ: <span id="totalCount">0</span></div></div>
      <div style="display:flex;gap:8px">
        <input id="search" class="input search" placeholder="–ü–æ–∏—Å–∫: –∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, email">
        <select id="filterResponsible" class="select input">
          <option value="">–í—Å–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ</option>
          <option value="–°–µ—Ä–≥–µ–π">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –°–µ—Ä–≥–µ–π</option>
          <option value="–î–∞–º–∏—Ä">–ú–∞—Å—Ç–µ—Ä –î–∞–º–∏—Ä</option>
        </select>
      </div>
    </div>

    <div id="leads" class="leads-list" aria-live="polite" style="margin-top:12px">
      <div class="empty" id="emptyMsg">–õ–∏–¥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ù–∞–∂–º–∏—Ç–µ ¬´+ –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞¬ª</div>
    </div>
  </div>

  <div class="grid" style="margin-top:12px">
    <div>
      <div class="card">
        <strong>–¢–∞–±–ª–∏—Ü–∞</strong>
        <table class="table" id="tablePreview">
          <thead><tr><th>–ò–º—è</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>

    <div>
      <div class="card">
        <strong>–§–æ—Ä–º–∞</strong>
        <div style="margin-top:10px" id="formPanel">
          <input id="f_id" type="hidden">
          <div style="display:flex;flex-direction:column;gap:8px">
            <input id="f_name" class="input" placeholder="–§–ò–û">
            <input id="f_phone" class="input" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
            <input id="f_email" class="input" placeholder="Email">
            <input id="f_company" class="input" placeholder="–ö–æ–º–ø–∞–Ω–∏—è">
            <select id="f_responsible" class="input"><option value="–°–µ—Ä–≥–µ–π">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –°–µ—Ä–≥–µ–π</option><option value="–î–∞–º–∏—Ä">–ú–∞—Å—Ç–µ—Ä –î–∞–º–∏—Ä</option></select>
            <select id="f_status" class="input"><option>–ù–æ–≤—ã–π</option><option>–í —Ä–∞–±–æ—Ç–µ</option><option>–ó–∞–≤–µ—Ä—à—ë–Ω</option></select>
            <textarea id="f_comment" class="input" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
            <div style="display:flex;gap:8px;justify-content:flex-end">
              <button id="saveBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              <button id="resetBtn" class="btn btn-ghost">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:12px" class="card">
        <strong>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</strong>
        <div style="margin-top:8px;display:flex;flex-direction:column;gap:8px">
          <button id="importSampleBtn" class="btn btn-ghost">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ</button>
          <button id="clearLocalBtn" class="btn btn-ghost">–°—Ç–µ—Ä–µ—Ç—å localStorage</button>
          <div class="small">–°–æ–≤–µ—Ç: —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ CSV –ø–µ—Ä–µ–¥ –æ—á–∏—Å—Ç–∫–æ–π.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer" style="margin-top:18px">
    ¬© 2025 TEHNOAPP ‚Äî –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é üíó
  </div>
</div>

<!-- welcome modal -->
<div id="welcomeModal" class="modal-backdrop" style="display:none">
  <div class="modal">
    <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ TEHNOAPP CRM üíó</h3>
    <p style="color:var(--muted)">–£–ø—Ä–∞–≤–ª—è–π –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ—Å—Ç–æ –∏ –∫—Ä–∞—Å–∏–≤–æ</p>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
      <button id="startBtn" class="btn btn-primary">–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</button>
    </div>
  </div>
</div>

<script>
/* TEHNOAPP index.html ‚Äî ready for GitHub Pages */
const STORAGE_KEY = "TEHNOAPP_CRM_V5";
let leads = [];

// helpers
const qs = s=>document.querySelector(s);
const qsa = s=>Array.from(document.querySelectorAll(s));
const uid = ()=>'id-'+Math.random().toString(36).slice(2,9);
function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function storageAvailable(type){
  try{var storage=window[type],x='__test__'; storage.setItem(x,x); storage.removeItem(x); return true;}
  catch(e){ return false;}
}
const canSave = storageAvailable('localStorage');
if(!canSave){ qs('#storageWarning').style.display='block'; }

// load/save
function load(){ if(canSave){ const raw=localStorage.getItem(STORAGE_KEY); if(raw) try{ leads=JSON.parse(raw) }catch(e){ leads=[] } else leads=[] } else leads=[] }
function save(){ if(canSave) localStorage.setItem(STORAGE_KEY, JSON.stringify(leads)); render(); }
function formatDate(ts){ return new Date(ts).toLocaleString(); }

// render
function render(){
  const container = qs('#leads'); container.innerHTML='';
  const filtered = applyFilters(leads);
  qs('#totalCount').textContent = filtered.length;
  if(filtered.length===0){ qs('#emptyMsg').style.display='block'; }
  else{ qs('#emptyMsg').style.display='none';
    filtered.forEach(l=>{
      const el=document.createElement('div'); el.className='lead-item';
      el.innerHTML = `<div style="flex:1"><strong>${escapeHtml(l.name||'(–±–µ–∑ –∏–º–µ–Ω–∏)')}</strong><div class="lead-meta">${escapeHtml(l.phone||'')}${l.email? ' ¬∑ '+escapeHtml(l.email):''}${l.company? ' ¬∑ '+escapeHtml(l.company):''}</div><div class="small">–°–æ–∑–¥–∞–Ω–æ: ${formatDate(l.created)}</div></div><div style="min-width:140px;text-align:right"><div class="lead-actions"><button class="btn btn-ghost btn-edit" data-id="${l.id}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button><button class="btn btn-ghost btn-del" data-id="${l.id}">–£–¥–∞–ª–∏—Ç—å</button></div><div style="margin-top:8px" class="kv"><span class="small">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:</span> <div class="badge" style="display:inline-block;margin-left:8px">${escapeHtml(l.responsible||'')}</div></div><div style="margin-top:6px" class="kv"><span class="small">–°—Ç–∞—Ç—É—Å:</span> <span class="small" style="margin-left:8px">${escapeHtml(l.status||'–ù–æ–≤—ã–π')}</span></div></div>`;
      container.appendChild(el);
    });
  }
  // table
  const tbody = qs('#tableBody'); tbody.innerHTML='';
  filtered.forEach(l=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${escapeHtml(l.name||'')}</td><td>${escapeHtml(l.phone||'')}</td><td>${escapeHtml(l.responsible||'')}</td><td>${escapeHtml(l.status||'–ù–æ–≤—ã–π')}</td>`; tbody.appendChild(tr); });
  attachHandlers();
}

// handlers
function attachHandlers(){
  qsa('.btn-edit').forEach(b=> b.onclick = e=>{ const id=e.currentTarget.dataset.id; const it=leads.find(x=>x.id===id); if(!it) return; qs('#f_id').value=it.id; qs('#f_name').value=it.name; qs('#f_phone').value=it.phone; qs('#f_email').value=it.email; qs('#f_company').value=it.company; qs('#f_responsible').value=it.responsible; qs('#f_status').value=it.status||'–ù–æ–≤—ã–π'; qs('#f_comment').value=it.comment; window.scrollTo({top:0,behavior:'smooth'}); });
  qsa('.btn-del').forEach(b=> b.onclick = e=>{ const id=e.currentTarget.dataset.id; if(confirm('–£–¥–∞–ª–∏—Ç—å –ª–∏–¥–∞?')){ leads = leads.filter(x=>x.id!==id); save(); } });
}

// filters/search
function applyFilters(list){ const q = qs('#search').value.trim().toLowerCase(); const resp = qs('#filterResponsible').value; return list.filter(l=>{ if(resp && l.responsible!==resp) return false; if(!q) return true; const hay = ((l.name||'')+' '+(l.phone||'')+' '+(l.email||'')+' '+(l.company||'')+' '+(l.comment||'')).toLowerCase(); return hay.indexOf(q)!==-1; }); }

// form actions
qs('#saveBtn').addEventListener('click', ()=>{ const id=qs('#f_id').value; const name=qs('#f_name').value.trim(); const phone=qs('#f_phone').value.trim(); const email=qs('#f_email').value.trim(); const company=qs('#f_company').value.trim(); const responsible=qs('#f_responsible').value; const status=qs('#f_status').value; const comment=qs('#f_comment').value.trim(); if(!name && !phone){ alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã –∏–º—è –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω.'); return; } if(id){ const idx=leads.findIndex(x=>x.id===id); if(idx!==-1){ leads[idx] = {...leads[idx], name, phone, email, company, responsible, status, comment, updated:Date.now()}; } } else{ leads.unshift({ id: uid(), name, phone, email, company, responsible, status, comment, created: Date.now() }); } qs('#f_id').value=''; qs('#f_name').value=''; qs('#f_phone').value=''; qs('#f_email').value=''; qs('#f_company').value=''; qs('#f_responsible').value='–°–µ—Ä–≥–µ–π'; qs('#f_status').value='–ù–æ–≤—ã–π'; qs('#f_comment').value=''; save(); });
qs('#resetBtn').addEventListener('click', ()=>{ qs('#f_id').value=''; qs('#f_name').value=''; qs('#f_phone').value=''; qs('#f_email').value=''; qs('#f_company').value=''; qs('#f_responsible').value='–°–µ—Ä–≥–µ–π'; qs('#f_status').value='–ù–æ–≤—ã–π'; qs('#f_comment').value=''; });

// import/export
qs('#exportBtn').addEventListener('click', ()=>{ exportCSV(leads); });
function exportCSV(items, filename='tehnoapp_leads.csv'){ const header=['Lead ID','Full Name','Phone','Email','Company','Responsible','Status','Comment','Created At']; const rows = items.map(it=>[it.id,it.name,it.phone,it.email,it.company,it.responsible,it.status,it.comment,new Date(it.created).toLocaleString()]); const csv = [header.join(',')].concat(rows.map(r=>r.map(cell=>'"'+String((cell||'')).replace(/"/g,'""')+'"').join(','))).join('\n'); const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=filename; document.body.appendChild(a); a.click(); a.remove(); setTimeout(()=>URL.revokeObjectURL(url),1000); }
qs('#importInput').addEventListener('change', e=>{ const f=e.target.files[0]; if(!f) return; const reader=new FileReader(); reader.onload=ev=>{ const text=ev.target.result; const lines=text.split(/\r?\n/).filter(Boolean); if(lines.length<2){ alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV'); return; } const header=lines[0].split(',').map(h=>h.replace(/(^"|"$)/g,'').trim()); const cols=lines.slice(1).map(l=>{ const values=l.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)||[]; return values.map(v=>v.replace(/(^"|"$)/g,'')); }); const mapped=cols.map(values=>{ const obj={}; header.forEach((h,i)=>obj[h]=values[i]||''); return obj; }); const imported=mapped.map(m=>({ id: m['Lead ID']||uid(), name:m['Full Name']||m['FullName']||'', phone:m['Phone']||'', email:m['Email']||'', company:m['Company']||'', responsible:m['Responsible']||'–°–µ—Ä–≥–µ–π', comment:m['Comment']||m['Notes']||'', created: Date.now(), status:m['Status']||'–ù–æ–≤—ã–π'})); leads = imported.concat(leads); save(); qs('#importInput').value=''; alert('–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω: –¥–æ–±–∞–≤–ª–µ–Ω–æ '+imported.length+' –∑–∞–ø–∏—Å–µ–π.'); }; reader.readAsText(f,'utf-8'); });

// delete/clear
qs('#deleteAllBtn').addEventListener('click', ()=>{ if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?')){ leads=[]; if(canSave) localStorage.removeItem(STORAGE_KEY); render(); } });
qs('#clearBtn').addEventListener('click', ()=>{ if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ª–∏–¥—ã?')){ leads=[]; save(); } });
qs('#clearLocalBtn').addEventListener('click', ()=>{ if(confirm('–û—á–∏—Å—Ç–∏—Ç—å localStorage? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –ª–∏–¥—ã.')){ localStorage.removeItem(STORAGE_KEY); leads=[]; render(); } });
qs('#importSampleBtn').addEventListener('click', ()=>{ const sample=[{id:uid(),name:'–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',phone:'+7 912 345-67-89',email:'ivan@example.com',company:'–û–û–û ¬´–ü—Ä–∏–º–µ—Ä¬ª',responsible:'–°–µ—Ä–≥–µ–π',comment:'–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è —Ç–∞—Ä–∏—Ñ–æ–º',created:Date.now(),status:'–ù–æ–≤—ã–π'},{id:uid(),name:'–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞',phone:'+7 901 234-56-78',email:'maria@example.com',company:'–ò–ü ¬´–ü–µ—Ç—Ä–æ–≤–∞¬ª',responsible:'–î–∞–º–∏—Ä',comment:'–ó–∞–ø—Ä–æ—Å –Ω–∞ –º–æ–Ω—Ç–∞–∂',created:Date.now(),status:'–í —Ä–∞–±–æ—Ç–µ'}]; leads = sample.concat(leads); save(); });

// search/filter
qs('#search').addEventListener('input', ()=> render());
qs('#filterResponsible').addEventListener('change', ()=> render());

// welcome modal (every open)
const welcomeModal = qs('#welcomeModal');
const startBtn = qs('#startBtn');
startBtn.addEventListener('click', ()=>{ welcomeModal.style.display='none'; });

// init
load();
render();
welcomeModal.style.display='flex';
</script>
</body>
</html>
